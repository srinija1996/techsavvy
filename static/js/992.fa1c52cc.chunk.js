"use strict";(self.webpackChunktechsavvy=self.webpackChunktechsavvy||[]).push([[992],{5992:(e,a,t)=>{t.r(a),t.d(a,{default:()=>G});var o=t(6446),r=t(5043),i=t(5865),l=t(9336),n=t(8089),s=t(7392),c=t(378),d=t(2143),u=t(6971),x=t(3217),h=t(1906),p=t(5899),g=t(6363),m=t(579);const v=e=>{let{setSelectedCategories:a,selectedCategories:t,onSetData:l,isLoading:n}=e;const[v,C]=(0,r.useState)(null),[A,b]=(0,r.useState)([]),[f,j]=(0,r.useState)(t),S=Boolean(v);(0,r.useEffect)((()=>{(0,g.Om)().then((e=>{var a;b(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.result)})).catch((e=>console.log(e)))}),[]);const y=()=>{C(null)};return(0,m.jsxs)(r.Fragment,{children:[(0,m.jsx)(o.A,{sx:{display:"flex",alignItems:"center",textAlign:"center"},children:(0,m.jsxs)(s.A,{onClick:e=>{C(e.currentTarget)},size:"small","aria-controls":S?"account-menu":void 0,"aria-haspopup":"true","aria-expanded":S?"true":void 0,sx:{border:"solid 1px #c9c4c4",borderRadius:"8px",p:"10px"},children:[(0,m.jsx)(i.A,{children:"Select Metrics"}),(0,m.jsx)(p.A,{})]})}),(0,m.jsxs)(c.A,{anchorEl:v,id:"account-menu",open:S,onClose:y,PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1.5,p:1.5,"& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1},"&::before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) rotate(45deg)",zIndex:0}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[null===A||void 0===A?void 0:A.map((e=>(0,m.jsx)(d.A,{sx:{p:0},children:(0,m.jsx)(u.A,{control:(0,m.jsx)(x.A,{name:"basic-checkbox"}),checked:f.some((a=>a===e.code)),sx:{width:"100%",m:0},label:null===e||void 0===e?void 0:e.label,onChange:(a,t)=>((e,a)=>{j((e=>e.some((e=>e===a))?e.filter((e=>e!==a)):[...e,a]))})(0,e.code)})},e.code))),(0,m.jsxs)(o.A,{display:"flex",justifyContent:"space-around",children:[(0,m.jsx)(h.A,{variant:"contained",sx:{backgroundColor:"#f1f1f1",color:"black",textTransform:"capitalize"},size:"small",onClick:y,children:"Cancel"}),(0,m.jsx)(h.A,{sx:{textTransform:"capitalize"},size:"large",variant:"contained",onClick:()=>{(async()=>{a(f),l(f)})(),y()},disabled:n,children:"Apply"})]})]})]})};var C=t(3549);const A=(e,a)=>{const t=["CTR","CR_perc","ACOS"];switch(!0){case["Spend","Revenue","AOV","CPM","CPC","CPA","CPO"].includes(e):return"\u20b9".concat(a.toFixed(2));case t.includes(e):return"".concat(a.toFixed(2),"%");default:return a.toFixed(2)}};var b=t(8982);const f=e=>{var a,t;let{selectedCategories:s,setSelectedCategories:c,onSetData:d,data:u,isLoading:x}=e;const h=(0,r.useContext)(b.B);return(0,m.jsxs)(o.A,{sx:{backgroundColor:"white",borderRadius:"8px"},children:[(0,m.jsxs)(o.A,{display:"flex",flexWrap:"wrap",justifyContent:"space-between",px:2,children:[(0,m.jsxs)(o.A,{sx:{padding:"10px"},children:[(0,m.jsx)(i.A,{children:"Performance Chart"}),(0,m.jsx)(i.A,{sx:{color:"gray"},variant:"caption",children:"Key Metrics for Dayparting Schedule Performance Evaluation"})]}),(0,m.jsx)(v,{setSelectedCategories:c,selectedCategories:s,onSetData:d,isLoading:x})]}),(0,m.jsx)(l.A,{}),(0,m.jsx)(o.A,{ref:null===h||void 0===h?void 0:h.appRef,children:(0,m.jsx)(n.b,{series:null===u||void 0===u||null===(a=u.series)||void 0===a?void 0:a.map((e=>({...e,label:e.name,area:!0,valueFormatter:a=>null===a?"":A(null===e||void 0===e?void 0:e.name,a)}))),loading:null===u||void 0===u?void 0:u.isLoading,xAxis:[{data:null===u||void 0===u||null===(t=u.categories)||void 0===t?void 0:t.map((e=>(0,C.eQ)(e))),scaleType:"point",valueFormatter:C.yv,disableTicks:!0}],yAxis:[{disableLine:!0,disableTicks:!0,valueFormatter:e=>e>1e3?"\u20b9".concat((e/1e3).toFixed(1),"k"):"\u20b9".concat(e.toFixed(1))}],height:500,grid:{horizontal:!0},legend:{hidden:!0},sx:{"& .MuiChartsGrid-horizontalLine":{strokeDasharray:"10 5",strokeWidth:1},"& .MuiAreaElement-root":{opacity:.02},"& .css-6i3py-MuiChartsSurface-root":{overflow:"scroll"},p:2,m:0}})})]})};var j=t(9650),S=t(1806),y=t(4882),I=t(8076),w=t(2420),k=t(3460);function R(e){let a,t,o;if(4===e.length)a=parseInt(e[1]+e[1],16),t=parseInt(e[2]+e[2],16),o=parseInt(e[3]+e[3],16);else{if(7!==e.length)throw new Error("Invalid HEX color");a=parseInt(e[1]+e[2],16),t=parseInt(e[3]+e[4],16),o=parseInt(e[5]+e[6],16)}return[a,t,o]}const D=e=>{let{index:a,value:t,minValue:o,maxValue:r,reverse:i}=e;a=a>5?a%5:a;const l=[{maxColor:"#bfadf3",minColor:"#ede8fc"},{maxColor:"#ffbfeb",minColor:"#ffeaf8"},{maxColor:"#16abd4",minColor:"#aee7f7"},{maxColor:"#f1c9a6",minColor:"#f1e1d3"},{maxColor:"#edeb88",minColor:"#e5e5c3"},{maxColor:"#c1c6bc",minColor:"#eaeee6"}],n=i?l[a].maxColor:l[a].minColor,s=i?l[a].minColor:l[a].maxColor,[c,d,u]=R(n),[x,h,p]=R(s),g=(t-o)/(r-o);return function(e,a,t){return"#"+[e,a,t].map((e=>{const a=e.toString(16);return 1===a.length?"0"+a:a})).join("")}(Math.round(c+(x-c)*g),Math.round(d+(h-d)*g),Math.round(u+(p-u)*g))};var M=t(7121);const z=[1,2,3,4,5],L=[1,2,3,4,5,6,7,8,9,10,11,12],O=()=>(0,m.jsx)(j.A,{children:(0,m.jsx)(S.A,{children:z.map((()=>(0,m.jsx)(I.A,{children:L.map((()=>(0,m.jsx)(w.A,{colSpan:1,sx:{p:0,border:"solid 3px white"},children:(0,m.jsx)(M.A,{sx:{bgcolor:"grey.900"},variant:"rectangular",width:"80px",height:"35px"})})))})))})}),F=e=>{var a;let{heatMapData:t,selectedCategories:l}=e;const{data:n,rangeDetails:s,isLoading:c}=t,d=(0,r.useContext)(b.B);return(0,r.useEffect)((()=>{if(d){var e;const{mainContentRef:a,setMainContentHeight:t}=d;t(null===a||void 0===a||null===(e=a.current)||void 0===e?void 0:e.scrollHeight)}})),(0,m.jsxs)(o.A,{sx:{backgroundColor:"white",borderRadius:"8px",mt:"10px"},children:[(0,m.jsxs)(o.A,{sx:{padding:"10px"},children:[(0,m.jsx)(i.A,{children:"Heat Map"}),(0,m.jsx)(i.A,{sx:{color:"gray"},variant:"caption",children:"Select Hours to schedule Dayparting"})]}),(0,m.jsx)(o.A,{p:2,children:c||0===(null===n||void 0===n?void 0:n.length)?(0,m.jsx)(O,{}):(0,m.jsx)(r.Suspense,{fallback:(0,m.jsx)(O,{}),children:(0,m.jsx)(j.A,{sx:{width:"98%"},children:(0,m.jsxs)(S.A,{children:[(0,m.jsxs)(y.A,{children:[(0,m.jsxs)(I.A,{children:[(0,m.jsx)(w.A,{colSpan:1,sx:{borderBottom:"none"}}),null===n||void 0===n?void 0:n.map((e=>(0,m.jsx)(w.A,{size:"small",align:"center",colSpan:l.length,sx:{borderBottom:"none",color:"gray"},children:e.weekday})))]}),(0,m.jsxs)(I.A,{children:[(0,m.jsx)(w.A,{sx:{borderBottom:"none"},size:"small",colSpan:1}),null===n||void 0===n?void 0:n.map((()=>l.map((e=>(0,m.jsx)(w.A,{size:"small",align:"center",colSpan:1,children:e})))))]})]}),(0,m.jsxs)(k.A,{children:[null===(a=n[0])||void 0===a?void 0:a.Hourly_Data.map(((e,a)=>{var t,o,r;return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(I.A,{children:[(0,m.jsx)(w.A,{sx:{border:"none",color:"gray"},size:"small",align:"left",colSpan:1,children:(0,C.gW)(null===(t=n[0])||void 0===t||null===(o=t.Hourly_Data)||void 0===o||null===(r=o[a])||void 0===r?void 0:r.time_part)}),null===n||void 0===n?void 0:n.map((e=>{var t,o;return null===(o=null===e||void 0===e?void 0:e.Hourly_Data[a],t=Object.keys(o).filter((e=>!["show","time_part"].includes(e))))||void 0===t?void 0:t.map((t=>{var o,r;return(0,m.jsx)(w.A,{sx:{color:"blue",border:"solid 3px white",backgroundColor:D({minValue:null===(o=s[t])||void 0===o?void 0:o.min,maxValue:null===(r=s[t])||void 0===r?void 0:r.max,index:l.indexOf(t),value:Number(null===e||void 0===e?void 0:e.Hourly_Data[a][t]),reverse:["CPC","CPM","CPO","ACOS","CPA"].includes(t)})},size:"small",align:"center",colSpan:1,children:A(t,null===e||void 0===e?void 0:e.Hourly_Data[a][t])})}))}))]})})})),(0,m.jsxs)(I.A,{children:[(0,m.jsx)(w.A,{sx:{fontWeight:600},size:"small",align:"left",colSpan:1,children:"Total"}),null===t||void 0===t?void 0:t.totalRow.flat().map((e=>(0,m.jsx)(w.A,{sx:{fontWeight:600,border:"solid 3px white",borderBottom:0,backgroundColor:"rgba(0, 0, 0, 0.12)"},size:"small",align:"center",colSpan:1,children:e.toFixed(2)})))]})]})]})})})})]})};var N=t(3216);const G=()=>{const[e,a]=(0,r.useState)({categories:[],series:[],isLoading:!1}),[t,i]=(0,r.useState)({data:[],rangeDetails:{},isLoading:!1,totalRow:[]}),[l,n]=(0,r.useState)(["CR_perc","ACOS","ROAS"]),s=localStorage.getItem("token"),c=(0,N.Zp)();(0,r.useEffect)((()=>{s||c("/")})),(0,r.useEffect)((()=>{d(l)}),[l]);const d=async e=>{a((e=>({...e,isLoading:!0}))),i((e=>({...e,isLoading:!0}))),(0,g.VV)({metrics:e}).then((e=>a((a=>({...a,...e.data.result}))))).catch((e=>console.log(e))).finally((()=>a((e=>({...e,isLoading:!1}))))),(0,g.NK)({metrics:e}).then((e=>i((a=>({...a,data:e.data.result,rangeDetails:e.data.rangeDetails,totalRow:e.data.result.map((()=>Object.entries(e.data.result[0]).filter((e=>e[0].startsWith("Total"))).map((e=>e[1]))))}))))).catch((e=>console.log(e))).finally((()=>i((e=>({...e,isLoading:!1})))))};return s?(0,m.jsxs)(o.A,{sx:{p:"10px"},children:[(0,m.jsx)(f,{selectedCategories:l,setSelectedCategories:n,onSetData:d,data:e,isLoading:(null===e||void 0===e?void 0:e.isLoading)||t.isLoading}),(0,m.jsx)(o.A,{sx:{pb:5},children:(0,m.jsx)(F,{heatMapData:t,selectedCategories:l})})]}):null}},6363:(e,a,t)=>{t.d(a,{NK:()=>c,Om:()=>n,VV:()=>s,Bi:()=>l});var o=t(6213);const r=o.A.create({baseURL:"https://coreapi.hectorai.live/api/day-parting",headers:{"X-USER-IDENTITY":"U2FsdGVkX18lreBwDMZIZaWXmCA+9GGYXAFttifVV7ovRjRGNNlnl3F8QSfmgxbGrm4zk42ud8ygR0rZccDFlOVDj01aIUTjKrX6TNza+qoIkSe0xGH0MxBlUXrV+c+ULtgFHS9XcTXbrIGbSN1Cwt18SZK5UOGF3aavkG5ZGXwOAopznMUp4CJOxE9a7DzNsb0rJpsguSXehn+Fw0b6GT30m/c0+7Nhbtwi8GFflEgr8F41hE4jMoLwCEajSkxQhTxorAqtJRF0tlM5sUeAvBODqx4sZMB8MNv9v9NzQ7cA+P+FKB6VSS9QIwRx5PC4LQnmthfupakaZmnRL1YbZ56rPbt8lu3QSRS1yuV/GwRuCN3MBwaHitsgzMYEnAMiYGup+W/nbNsukqCXhSZGtg==",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY2OGI0ZTNhN2Y1YmU4ZDY2MjVlN2I0MiIsImZ1bGxOYW1lIjoiU3lzdGVtIFRlc3QiLCJlbWFpbCI6InRlc3RAZGV2LmNvbSIsInNlc3Npb25JZCI6InJhbmRvbVN0cmluZyIsImlhdCI6MTcyMDQwNjQzNH0.oo2gUHroTcJ7X-I0-hNvtuG4tq6sGL2yr4Veaf37JPc"}});var i=t(3549);const l=async e=>{let{email:a,password:t,isLoggedInHere:r}=e;return await o.A.post("https://coreapi.hectorai.live/api/auth/login",{email:a,password:t,isLoggedInHere:r})},n=async()=>await r.post("/DayPartingFilterList",{type:"customizeMetrics"}),s=async e=>{let{metrics:a}=e;return await r.post("/DayPartingPerformanceGraphList",{startDate:i.M1,endDate:i.Rd,metrics:a.length>0?a:["CR_perc","ACOS","ROAS"]})},c=async e=>{let{metrics:a}=e;return await r.post("/heatmap-list",{startDate:i.M1,endDate:i.Rd,metrics:a.length>0?a:["CR_perc","ACOS","ROAS"]})}}}]);
//# sourceMappingURL=992.fa1c52cc.chunk.js.map